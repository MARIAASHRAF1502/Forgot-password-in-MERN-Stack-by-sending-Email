<html>
    <head>
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Josefin+Sans&family=Patua+One&family=Poppins:wght@100;400&family=Ubuntu&display=swap" rel="stylesheet">

        <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
        <style>
            *{
                padding:0px;
                margin:0px;
                font-family: 'Ubuntu', sans-serif;
            }
            .forgetForm > p{
                margin:10px;
            }

            .forgetForm{
                display:flex;
                flex-direction: column;
                justify-content: center;
                align-items: center;
                width:500px;
                height: 550px;
                margin-left: 500px;
                margin-top:75px;
                border:1px solid black;
                border-radius: 10px;
                box-shadow: rgba(0, 0, 0, 0.16) 0px 3px 6px, rgba(0, 0, 0, 0.23) 0px 3px 6px;
            }

            .forgetForm > [type="text"]{
                width:300px;
                height:40px;
                padding-left: 10px;
            }


           .forgetForm > input[type="text"]:focus{
            outline-color: rgb(12, 197, 34);
            }



           .forgetForm > [type="password"]{
               width:300px;
               height:40px;
               padding-left: 10px;
           }
           
           .forgetForm > input[type="password"]:focus{
               outline-color: rgb(12, 197, 34);
           }
           
           .forgetForm > [type="button"]{
               color:#ffff;
               margin-top:25px;
               width:250px;
               height:40px;
               background-color:#4681f4;
               border:0px solid black;
               font-size: 14px;
               border-radius: 10px;
           }
           
           .forgetForm > [type="button"]:hover{
               background-color : #5783db;
               cursor:pointer;
           }

           #msg{
            display: flex;
            justify-content: center;
            background-color: rgb(255,243,205);
            font-size: 18px;
            color:rgb(133,100,4);
            width:400px;
            height:30px;
            margin: 10px;
            align-items: center;
            padding: 10px;
           }

           #msg > span{
            margin:10px;
            color:black;
           }
           
        </style>

    </head>


    <body>
        <script>
            const submit = async (e)=>{
        
                const emailid = document.getElementById("emailid").value;
                const pwd = document.getElementById("pwd").value;
                const cfmPwd = document.getElementById("cfmPwd").value;

                if(pwd != cfmPwd){
                    document.getElementById("error").innerHTML="password mismatch";
                    return;
                }else if(pwd == "" || cfmPwd == ""){
                    document.getElementById("error").innerHTML="password field should not be empty";
                    return;
                }
                else{
                    document.getElementById("error").innerHTML="";
                }

                await fetch("http://localhost:8000/request",
                {
                    method : 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                        },
                    body : JSON.stringify({emailid : emailid , pwd : pwd, cfmPwd : cfmPwd})
                }).then((response)=>
                {
                    // var d = document.getElementById('msg');
                    var link = document.createElement('a');
                    link.href = 'http://localhost:5173/';
                    link.target = '_blank';
                    link.innerText = 'click to login';
                
                    document.getElementById("error").innerHTML = "Password reset successful "+link.outerHTML;

                }).catch((err)=>
                {
                    console.log(err);
                })
                
            }
        </script>
        <div class="forgetForm">
            <p>Password Reset Form</p>
            <input type="text" id="emailid" value = <%=emailid%> disabled></br>
            <input type="password" id="pwd" placeholder="Password"></br>
            <input type="password" id="cfmPwd" placeholder="Confirm Password">
            <input type="button" onclick="submit()" value="Send">
            <div id="msg">
            <span class="material-symbols-outlined">info</span>
            <p id="error">Please enter a strong password.</p>
            </div>
        </div>
    </body>
</html>